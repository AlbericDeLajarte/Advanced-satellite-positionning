function [r, b] = bancroft(r_k, P_k)
% r_k : k x 3 matrix, k being the number of satellites 
% P_k : k x 1  matrix
B = [r_k, P_k]; %k x 4 matrix
disp(size(B))
[k, ~] = size(r_k); 
e = ones([1, k])';
alpha = zeros(k,1)
%alpha = 0.5*lorentz_product(B, B')
%disp(size(alpha))

for i = 1:k
    alpha(i) =  0.5*lorentz_product([r_k(i, :), P_k(i)], [r_k(i, :), P_k(i)])
    %disp(size(alpha(i)))
end


if k > 4
    Bplus = (B'*B)\B';
    B = Bplus;
end

[r, b] = solve_equation(B, alpha, e);
end